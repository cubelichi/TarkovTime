<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tarkov Time Display</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
        }
        .container {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            transition: background-color 0.5s ease;
        }
        h2 {
            margin-top: 0;
        }
        #cultistSpawnTime {
            font-weight: bold;
            color: #ff0000;
            display: none;
        }
        .cultist-active {
            background-color: #ffcccc;
        }
    </style>
</head>
<body>
    <div class="container" id="mainContainer">
        <h2>時間表示</h2>
        <p>現在時刻: <span id="realTime"></span></p>
        <p>Tarkov Left: <span id="leftTime"></span></p>
        <p>Tarkov Right: <span id="rightTime"></span></p>
        <p id="cultistSpawnTime">Cultist SPAWN TIME</p>
    </div>
    <script>
        let tarkovLeft = new Date();
        let tarkovRight = new Date();
        let lastSyncTime = 0;

        function updateTimes() {
            const now = new Date();
            document.getElementById('realTime').textContent = now.toLocaleTimeString();

            // 7倍速で時間を進める
            const elapsedSeconds = (now.getTime() - lastSyncTime) / 1000;
            const tarkovElapsedSeconds = elapsedSeconds * 7;

            tarkovLeft.setSeconds(tarkovLeft.getSeconds() + tarkovElapsedSeconds);
            tarkovRight.setSeconds(tarkovRight.getSeconds() + tarkovElapsedSeconds);

            document.getElementById('leftTime').textContent = tarkovLeft.toLocaleTimeString();
            document.getElementById('rightTime').textContent = tarkovRight.toLocaleTimeString();

            checkCultistSpawnTime();
            lastSyncTime = now.getTime();
        }

        function checkCultistSpawnTime() {
            const leftHour = tarkovLeft.getHours();
            const rightHour = tarkovRight.getHours();
            const isCultistTime = (leftHour >= 22 || leftHour < 7) || (rightHour >= 22 || rightHour < 7);
            
            const cultistSpawnElement = document.getElementById('cultistSpawnTime');
            const mainContainer = document.getElementById('mainContainer');
            
            if (isCultistTime) {
                cultistSpawnElement.style.display = 'block';
                mainContainer.classList.add('cultist-active');
            } else {
                cultistSpawnElement.style.display = 'none';
                mainContainer.classList.remove('cultist-active');
            }
        }

        function syncTimeWithAPI() {
            fetch('https://tarkov-time.adam.id.au/api')
                .then(response => response.json())
                .then(data => {
                    tarkovLeft = new Date(`2000-01-01T${data.left}`);
                    tarkovRight = new Date(`2000-01-01T${data.right}`);
                    lastSyncTime = new Date().getTime();
                    updateTimes();
                })
                .catch(error => console.error('Error:', error));
        }

        // 初回の時間同期
        syncTimeWithAPI();

        // 1分ごとに時間を同期
        setInterval(syncTimeWithAPI, 60000);

        // 約143ミリ秒（1秒の7分の1）ごとに更新
        setInterval(updateTimes, 1000 / 7);
    </script>
</body>
</html>